# Copyright 2025 Lewa-Reka <lewareka.yt@gmail.com>
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

datetime:
  - platform: template
    name: "Time of Use 1 Start"
    id: time_of_use_1_start
    type: time
    optimistic: true
    initial_value: "00:00"
    restore_value: true
  - platform: template
    name: "Time of Use 2 Start"
    id: time_of_use_2_start
    type: time
    optimistic: true
    initial_value: "03:00"
    restore_value: true
  - platform: template
    name: "Time of Use 3 Start"
    id: time_of_use_3_start
    type: time
    optimistic: true
    initial_value: "06:00"
    restore_value: true
  - platform: template
    name: "Time of Use 4 Start"
    id: time_of_use_4_start
    type: time
    optimistic: true
    initial_value: "12:00"
    restore_value: true
  - platform: template
    name: "Time of Use 5 Start"
    id: time_of_use_5_start
    type: time
    optimistic: true
    initial_value: "18:00"
    restore_value: true
  - platform: template
    name: "Time of Use 6 Start"
    id: time_of_use_6_start
    type: time
    optimistic: true
    initial_value: "22:00"
    restore_value: true

select:
  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 1 Start"
    address: 148
    value_type: U_WORD
    icon: "mdi:clock-start"
    optionsmap: &tou_optionsmap
      "00:00": 0
      "00:30": 30
      "01:00": 100
      "01:30": 130
      "02:00": 200
      "02:30": 230
      "03:00": 300
      "04:00": 400
      "04:10": 410
      "04:30": 430
      "05:00": 500
      "05:30": 530
      "05:40": 540
      "06:00": 600
      "06:30": 630
      "07:00": 700
      "07:30": 730
      "08:00": 800
      "08:30": 830
      "09:00": 900
      "09:30": 930
      "10:00": 1000
      "10:30": 1030
      "11:00": 1100
      "11:30": 1130
      "12:00": 1200
      "12:30": 1230
      "13:00": 1300
      "13:30": 1330
      "14:00": 1400
      "14:30": 1430
      "15:00": 1500
      "15:30": 1530
      "16:00": 1600
      "16:30": 1630
      "17:00": 1700
      "17:30": 1730
      "18:00": 1800
      "18:30": 1830
      "19:00": 1900
      "19:30": 1930
      "20:00": 2000
      "20:30": 2030
      "21:00": 2100
      "21:30": 2130
      "22:00": 2200
      "22:30": 2230
      "23:00": 2300
      "23:30": 2330

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 2 Start"
    address: 149
    value_type: U_WORD
    icon: "mdi:clock-start"
    optionsmap: *tou_optionsmap

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 3 Start"
    address: 150
    value_type: U_WORD
    icon: "mdi:clock-start"
    optionsmap: *tou_optionsmap

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 4 Start"
    address: 151
    value_type: U_WORD
    icon: "mdi:clock-start"
    optionsmap: *tou_optionsmap

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 5 Start"
    address: 152
    value_type: U_WORD
    icon: "mdi:clock-start"
    optionsmap: *tou_optionsmap

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 6 Start"
    address: 153
    value_type: U_WORD
    icon: "mdi:clock-start"
    optionsmap: *tou_optionsmap

switch:
  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use"
    id: switch_time_of_use
    register_type: holding
    address: 146
    bitmask: 1
    icon: "mdi:toggle-switch"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 1 Charge Enable"
    id: switch_time_point_1_charge_enable
    register_type: holding
    address: 172
    bitmask: 1
    icon: "mdi:battery-plus"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 2 Charge Enable"
    id: switch_time_point_2_charge_enable
    register_type: holding
    address: 173
    bitmask: 1
    icon: "mdi:battery-plus"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 3 Charge Enable"
    id: switch_time_point_3_charge_enable
    register_type: holding
    address: 174
    bitmask: 1
    icon: "mdi:battery-plus"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 4 Charge Enable"
    id: switch_time_point_4_charge_enable
    register_type: holding
    address: 175
    bitmask: 1
    icon: "mdi:battery-plus"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 5 Charge Enable"
    id: switch_time_point_5_charge_enable
    register_type: holding
    address: 176
    bitmask: 1
    icon: "mdi:battery-plus"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 6 Charge Enable"
    id: switch_time_point_6_charge_enable
    register_type: holding
    address: 177
    bitmask: 1
    icon: "mdi:battery-plus"

number:
  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 1 Voltage"
    id: time_of_use_1_voltage
    register_type: holding
    address: 160
    unit_of_measurement: "V"
    device_class: voltage
    value_type: U_WORD
    multiply: 100
    min_value: 0
    max_value: 63
    step: 0.01
    icon: "mdi:sun-clock"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 2 Voltage"
    id: time_of_use_2_voltage
    register_type: holding
    address: 161
    unit_of_measurement: "V"
    device_class: voltage
    value_type: U_WORD
    multiply: 100
    min_value: 0
    max_value: 63
    step: 0.01
    icon: "mdi:sun-clock"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 3 Voltage"
    id: time_of_use_3_voltage
    register_type: holding
    address: 162
    unit_of_measurement: "V"
    device_class: voltage
    value_type: U_WORD
    multiply: 100
    min_value: 0
    max_value: 63
    step: 0.01
    icon: "mdi:sun-clock"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 4 Voltage"
    id: time_of_use_4_voltage
    register_type: holding
    address: 163
    unit_of_measurement: "V"
    device_class: voltage
    value_type: U_WORD
    multiply: 100
    min_value: 0
    max_value: 63
    step: 0.01
    icon: "mdi:sun-clock"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 5 Voltage"
    id: time_of_use_5_voltage
    register_type: holding
    address: 164
    unit_of_measurement: "V"
    device_class: voltage
    value_type: U_WORD
    multiply: 100
    min_value: 0
    max_value: 63
    step: 0.01
    icon: "mdi:sun-clock"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 6 Voltage"
    id: time_of_use_6_voltage
    register_type: holding
    address: 165
    unit_of_measurement: "V"
    device_class: voltage
    value_type: U_WORD
    multiply: 100
    min_value: 0
    max_value: 63
    step: 0.01
    icon: "mdi:sun-clock"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 1 Out Power"
    id: time_of_use_1_out_power
    unit_of_measurement: W
    device_class: power
    address: 154
    value_type: U_WORD
    icon: "mdi:power-plug"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 2 Out Power"
    id: time_of_use_2_out_power
    unit_of_measurement: W
    device_class: power
    address: 155
    value_type: U_WORD
    icon: "mdi:power-plug"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 3 Out Power"
    id: time_of_use_3_out_power
    unit_of_measurement: W
    device_class: power
    address: 156
    value_type: U_WORD
    icon: "mdi:power-plug"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 4 Out Power"
    id: time_of_use_4_out_power
    unit_of_measurement: W
    device_class: power
    address: 157
    value_type: U_WORD
    icon: "mdi:power-plug"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 5 Out Power"
    id: time_of_use_5_out_power
    unit_of_measurement: W
    device_class: power
    address: 158
    value_type: U_WORD
    icon: "mdi:power-plug"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 6 Out Power"
    id: time_of_use_6_out_power
    unit_of_measurement: W
    device_class: power
    address: 159
    value_type: U_WORD
    icon: "mdi:power-plug"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 1 SoC"
    unit_of_measurement: "%"
    address: 166
    min_value: 0
    max_value: 100
    step: 1
    value_type: U_WORD
    icon: "mdi:battery-clock"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 2 SoC"
    unit_of_measurement: "%"
    address: 167
    min_value: 0
    max_value: 100
    step: 1
    value_type: U_WORD
    icon: "mdi:battery-clock"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 3 SoC"
    unit_of_measurement: "%"
    address: 168
    min_value: 0
    max_value: 100
    step: 1
    value_type: U_WORD
    icon: "mdi:battery-clock"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 4 SoC"
    unit_of_measurement: "%"
    address: 169
    min_value: 0
    max_value: 100
    step: 1
    value_type: U_WORD
    icon: "mdi:battery-clock"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 5 SoC"
    unit_of_measurement: "%"
    address: 170
    min_value: 0
    max_value: 100
    step: 1
    value_type: U_WORD
    icon: "mdi:battery-clock"

  - platform: modbus_controller
    use_write_multiple: true
    modbus_controller_id: ${modbus_controller_id}
    name: "Time of Use 6 SoC"
    unit_of_measurement: "%"
    address: 171
    min_value: 0
    max_value: 100
    step: 1
    value_type: U_WORD
    icon: "mdi:battery-clock"
